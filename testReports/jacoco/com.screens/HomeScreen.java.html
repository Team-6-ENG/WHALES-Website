<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HomeScreen.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tests</a> &gt; <a href="index.source.html" class="el_package">com.screens</a> &gt; <span class="el_source">HomeScreen.java</span></div><h1>HomeScreen.java</h1><pre class="source lang-java linenums">package com.screens;

import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.Input;
import com.badlogic.gdx.ScreenAdapter;
import com.badlogic.gdx.graphics.GL20;
import com.badlogic.gdx.graphics.Texture;
import com.badlogic.gdx.graphics.g2d.SpriteBatch;
import com.badlogic.gdx.scenes.scene2d.Stage;
import com.badlogic.gdx.scenes.scene2d.ui.TextButton;
import com.badlogic.gdx.scenes.scene2d.utils.ChangeListener;
import com.badlogic.gdx.utils.viewport.ScreenViewport;
import com.badlogic.mazegame.Main;

/** A screen which displays the image of the homeScreen. */
public class HomeScreen extends ScreenAdapter {

  // Changed: store path in constant for testing
  public static final String IMG = &quot;screens/homeScreen.png&quot;;
  private static final float START_BUTTON_ORIGINAL_WIDTH = 315f;
  private static final float START_BUTTON_ORIGINAL_HEIGHT = 86f;
  private static final float LEADERBOARD_BUTTON_ORIGINAL_WIDTH = 150f;
  private static final float LEADERBOARD_BUTTON_ORIGINAL_HEIGHT = 50f;
  private static final float LEADERBOARD_BUTTON_TOP_OFFSET = 20f;
  private static final float LEADERBOARD_BUTTON_RIGHT_OFFSET = 20f;
  private static final float ACHIEVEMENTS_BUTTON_ORIGINAL_WIDTH = 150f;
  private static final float ACHIEVEMENTS_BUTTON_ORIGINAL_HEIGHT = 50f;
  private static final float ACHIEVEMENTS_BUTTON_TOP_OFFSET =
      80f; // Position below leaderboard button
  private static final float ACHIEVEMENTS_BUTTON_RIGHT_OFFSET = 20f;
  private final Main game;
  private Texture homeImage;
  // Change [17/12/2025] - Added Stage for UI buttons
  private Stage stage;
  // Change [17/12/2025] - Added Start Game button
  private TextButton startButton;
  // Change [20/12/2025] - Added Leaderboard button because user requested it in top right corner
  private TextButton leaderboardButton;
  // Change [01/01/2026] - Added Achievements button
  private TextButton achievementsButton;

  /** Initialise home screen. */
<span class="nc" id="L43">  public HomeScreen(Main game) {</span>
<span class="nc" id="L44">    this.game = game;</span>
<span class="nc" id="L45">  }</span>

  @Override
  public void show() {
    // Change [20/12/2025] - Only create resources if they don't exist because we need to avoid
    // recreating everything when returning from other screens
<span class="nc bnc" id="L51" title="All 2 branches missed.">    if (homeImage == null) {</span>
      // uses homeScreen PNG in assets
<span class="nc" id="L53">      homeImage = new Texture(Gdx.files.internal(IMG));</span>
    }

    // Change [20/12/2025] - Only create Stage if it doesn't exist because we need to avoid
    // recreating UI elements
<span class="nc bnc" id="L58" title="All 2 branches missed.">    if (stage == null) {</span>
      // Initialize Stage with ScreenViewport for pixel-perfect button rendering
<span class="nc" id="L60">      stage = new Stage(new ScreenViewport());</span>
    }
<span class="nc" id="L62">    Gdx.input.setInputProcessor(stage);</span>

    // Change [20/12/2025] - Only create buttons if they don't exist because we need to avoid
    // recreating UI elements
<span class="nc bnc" id="L66" title="All 2 branches missed.">    if (startButton == null) {</span>
      // Change [17/12/2025] - Create Start Game button for Home screen
<span class="nc" id="L68">      startButton = new TextButton(&quot;Start Game&quot;, Main.uiSkin);</span>
<span class="nc" id="L69">      startButton.setSize(315, 86);</span>

<span class="nc bnc" id="L71" title="All 2 branches missed.">      if (startButton.getLabel() != null) {</span>
<span class="nc" id="L72">        startButton.getLabel().setFontScale(2.0f);</span>
      }
<span class="nc" id="L74">      startButton.setPosition(</span>
<span class="nc" id="L75">          Main.VIEWPORT_SIZE.x / 2f - startButton.getWidth() / 2f + 8,</span>
          Main.VIEWPORT_SIZE.y * 0.3f + 55);

      // Change [04/01/2026] - Changed to show name input screen before starting game
      // Add click listener to start game
<span class="nc" id="L80">      startButton.addListener(</span>
<span class="nc" id="L81">          new ChangeListener() {</span>
            @Override
            public void changed(ChangeEvent event, com.badlogic.gdx.scenes.scene2d.Actor actor) {
<span class="nc" id="L84">              game.setScreen(new NameInputScreen(game));</span>
<span class="nc" id="L85">            }</span>
          });

<span class="nc" id="L88">      stage.addActor(startButton);</span>
    }

    // Change [20/12/2025] - Only create leaderboard button if it doesn't exist because we need to
    // avoid recreating UI elements
<span class="nc bnc" id="L93" title="All 2 branches missed.">    if (leaderboardButton == null) {</span>
      // Create Leaderboard button because user requested it in top right corner
<span class="nc" id="L95">      leaderboardButton = new TextButton(&quot;Leaderboard&quot;, Main.uiSkin);</span>
<span class="nc" id="L96">      leaderboardButton.setSize(</span>
          LEADERBOARD_BUTTON_ORIGINAL_WIDTH, LEADERBOARD_BUTTON_ORIGINAL_HEIGHT);

<span class="nc bnc" id="L99" title="All 2 branches missed.">      if (leaderboardButton.getLabel() != null) {</span>
<span class="nc" id="L100">        leaderboardButton.getLabel().setFontScale(1.2f);</span>
      }

      // Position in top right corner
<span class="nc" id="L104">      leaderboardButton.setPosition(</span>
<span class="nc" id="L105">          Main.VIEWPORT_SIZE.x - leaderboardButton.getWidth() - LEADERBOARD_BUTTON_RIGHT_OFFSET,</span>
<span class="nc" id="L106">          Main.VIEWPORT_SIZE.y - leaderboardButton.getHeight() - LEADERBOARD_BUTTON_TOP_OFFSET);</span>

      // Add click listener to open leaderboard
<span class="nc" id="L109">      leaderboardButton.addListener(</span>
<span class="nc" id="L110">          new ChangeListener() {</span>
            @Override
            public void changed(ChangeEvent event, com.badlogic.gdx.scenes.scene2d.Actor actor) {
<span class="nc" id="L113">              game.setScreen(new LeaderboardScreen(game, HomeScreen.this));</span>
<span class="nc" id="L114">            }</span>
          });

<span class="nc" id="L117">      stage.addActor(leaderboardButton);</span>
    }

    // Change [01/01/2026] - Create achievements button if it doesn't exist
<span class="nc bnc" id="L121" title="All 2 branches missed.">    if (achievementsButton == null) {</span>
<span class="nc" id="L122">      achievementsButton = new TextButton(&quot;Achievements&quot;, Main.uiSkin);</span>
<span class="nc" id="L123">      achievementsButton.setSize(</span>
          ACHIEVEMENTS_BUTTON_ORIGINAL_WIDTH, ACHIEVEMENTS_BUTTON_ORIGINAL_HEIGHT);

<span class="nc bnc" id="L126" title="All 2 branches missed.">      if (achievementsButton.getLabel() != null) {</span>
<span class="nc" id="L127">        achievementsButton.getLabel().setFontScale(1.2f);</span>
      }

      // Position in top right corner below leaderboard button
<span class="nc" id="L131">      achievementsButton.setPosition(</span>
<span class="nc" id="L132">          Main.VIEWPORT_SIZE.x - achievementsButton.getWidth() - ACHIEVEMENTS_BUTTON_RIGHT_OFFSET,</span>
<span class="nc" id="L133">          Main.VIEWPORT_SIZE.y - achievementsButton.getHeight() - ACHIEVEMENTS_BUTTON_TOP_OFFSET);</span>

      // Add click listener to open achievements
<span class="nc" id="L136">      achievementsButton.addListener(</span>
<span class="nc" id="L137">          new ChangeListener() {</span>
            @Override
            public void changed(ChangeEvent event, com.badlogic.gdx.scenes.scene2d.Actor actor) {
<span class="nc" id="L140">              game.setScreen(new AchievementScreen(game, HomeScreen.this));</span>
<span class="nc" id="L141">            }</span>
          });

<span class="nc" id="L144">      stage.addActor(achievementsButton);</span>
    }

    // Initialize button positions based on current screen size
<span class="nc" id="L148">    updateButtonPositions(Gdx.graphics.getWidth(), Gdx.graphics.getHeight());</span>
<span class="nc" id="L149">  }</span>

  @Override
  public void render(float delta) {
<span class="nc" id="L153">    Gdx.gl.glClearColor(0, 0, 0, 1);</span>
<span class="nc" id="L154">    Gdx.gl.glClear(GL20.GL_COLOR_BUFFER_BIT);</span>

    // Apply viewport to ensure correct rendering because we need consistent background display
<span class="nc" id="L157">    game.getViewport().apply();</span>
<span class="nc" id="L158">    SpriteBatch batch = game.getBatch();</span>
    // Set projection matrix to ensure correct coordinate system because we need proper background
    // rendering
<span class="nc" id="L161">    batch.setProjectionMatrix(game.getViewport().getCamera().combined);</span>
<span class="nc" id="L162">    batch.begin();</span>
    // put width and height as Viewport width and height
    // Use viewport world dimensions because we need to match the viewport coordinate system
<span class="nc" id="L165">    batch.draw(</span>
<span class="nc" id="L166">        homeImage, 0, 0, game.getViewport().getWorldWidth(), game.getViewport().getWorldHeight());</span>
<span class="nc" id="L167">    batch.end();</span>

    // Change [17/12/2025] - Update and draw Stage for buttons
<span class="nc" id="L170">    stage.act(delta);</span>
<span class="nc" id="L171">    stage.draw();</span>

<span class="nc bnc" id="L173" title="All 2 branches missed.">    if (Gdx.input.isKeyJustPressed(Input.Keys.ENTER)) {</span>
      // Change [04/01/2026] - Changed to show name input screen before starting game
      // Starts Game when Enter is pressed
<span class="nc" id="L176">      game.setScreen(new NameInputScreen(game));</span>
    }
<span class="nc" id="L178">  }</span>

  @Override
  public void resize(int width, int height) {
    // Change [17/12/2025] - Update Stage viewport on resize
<span class="nc bnc" id="L183" title="All 2 branches missed.">    if (stage != null) {</span>
<span class="nc" id="L184">      stage.getViewport().update(width, height, true);</span>
      // Update button position based on actual screen size for responsiveness
<span class="nc" id="L186">      updateButtonPositions(width, height);</span>
    }
<span class="nc" id="L188">  }</span>

  // Change [17/12/2025] - Update button size and position based on actual screen dimensions for
  // screen responsiveness
  private void updateButtonPositions(float screenWidth, float screenHeight) {
    // Calculate scale factors based on screen size relative to original viewport size
<span class="nc" id="L194">    float scaleX = screenWidth / Main.VIEWPORT_SIZE.x;</span>
<span class="nc" id="L195">    float scaleY = screenHeight / Main.VIEWPORT_SIZE.y;</span>
    // Calculate font scale using average of X and Y scales for readability
<span class="nc" id="L197">    float fontScale = (scaleX + scaleY) / 2f;</span>

<span class="nc bnc" id="L199" title="All 2 branches missed.">    if (startButton != null) {</span>
      // Update button size proportionally
<span class="nc" id="L201">      startButton.setSize(</span>
          START_BUTTON_ORIGINAL_WIDTH * scaleX, START_BUTTON_ORIGINAL_HEIGHT * scaleY);

      // Update font scale to match button size scaling
<span class="nc bnc" id="L205" title="All 2 branches missed.">      if (startButton.getLabel() != null) {</span>
<span class="nc" id="L206">        startButton.getLabel().setFontScale(fontScale);</span>
      }

<span class="nc" id="L209">      float relativeX = 0.5f;</span>
<span class="nc" id="L210">      float relativeY = 0.3f + (55f / Main.VIEWPORT_SIZE.y);</span>
<span class="nc" id="L211">      startButton.setPosition(</span>
<span class="nc" id="L212">          screenWidth * relativeX - startButton.getWidth() / 2f, screenHeight * relativeY);</span>
    }

    // Change [20/12/2025] - Update Leaderboard button position because we need to keep it in top
    // right corner
<span class="nc bnc" id="L217" title="All 2 branches missed.">    if (leaderboardButton != null) {</span>
      // Update button size proportionally
<span class="nc" id="L219">      leaderboardButton.setSize(</span>
          LEADERBOARD_BUTTON_ORIGINAL_WIDTH * scaleX, LEADERBOARD_BUTTON_ORIGINAL_HEIGHT * scaleY);

      // Update font scale to match button size scaling
<span class="nc bnc" id="L223" title="All 2 branches missed.">      if (leaderboardButton.getLabel() != null) {</span>
<span class="nc" id="L224">        leaderboardButton.getLabel().setFontScale(fontScale * 1.2f);</span>
      }

      // Position in top right corner with scaled offsets
<span class="nc" id="L228">      float rightOffset = LEADERBOARD_BUTTON_RIGHT_OFFSET * scaleX;</span>
<span class="nc" id="L229">      float topOffset = LEADERBOARD_BUTTON_TOP_OFFSET * scaleY;</span>
<span class="nc" id="L230">      leaderboardButton.setPosition(</span>
<span class="nc" id="L231">          screenWidth - leaderboardButton.getWidth() - rightOffset,</span>
<span class="nc" id="L232">          screenHeight - leaderboardButton.getHeight() - topOffset);</span>
    }

    // Change [01/01/2026] - Update Achievements button position
<span class="nc bnc" id="L236" title="All 2 branches missed.">    if (achievementsButton != null) {</span>
      // Update button size proportionally
<span class="nc" id="L238">      achievementsButton.setSize(</span>
          ACHIEVEMENTS_BUTTON_ORIGINAL_WIDTH * scaleX,
          ACHIEVEMENTS_BUTTON_ORIGINAL_HEIGHT * scaleY);

      // Update font scale to match button size scaling
<span class="nc bnc" id="L243" title="All 2 branches missed.">      if (achievementsButton.getLabel() != null) {</span>
<span class="nc" id="L244">        achievementsButton.getLabel().setFontScale(fontScale * 1.2f);</span>
      }

      // Position in top right corner below leaderboard button with scaled offsets
<span class="nc" id="L248">      float rightOffset = ACHIEVEMENTS_BUTTON_RIGHT_OFFSET * scaleX;</span>
<span class="nc" id="L249">      float topOffset = ACHIEVEMENTS_BUTTON_TOP_OFFSET * scaleY;</span>
<span class="nc" id="L250">      achievementsButton.setPosition(</span>
<span class="nc" id="L251">          screenWidth - achievementsButton.getWidth() - rightOffset,</span>
<span class="nc" id="L252">          screenHeight - achievementsButton.getHeight() - topOffset);</span>
    }
<span class="nc" id="L254">  }</span>

  @Override
  public void dispose() {
<span class="nc" id="L258">    homeImage.dispose();</span>
    // Change [17/12/2025] - Dispose Stage resources
<span class="nc bnc" id="L260" title="All 2 branches missed.">    if (stage != null) {</span>
<span class="nc" id="L261">      stage.dispose();</span>
    }
<span class="nc" id="L263">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>